# Results
```{r include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(tidyverse)
library(psych)
library(GGally)

#loading data 
school_clean <- read.csv("data/clean/school_clean.csv")
```

1. matrix dot plots for 5 different type of crimes

```{r}
school_crime <- select(school_clean, School.Year, Major.N, Oth.N, NoCrim.N, Prop.N, Vio.N)

pairs.panels(school_crime[,2:6], 
             method = "pearson", # correlation method
             hist.col = "#00AFBB",
             density = TRUE,  # show density plots
             ellipses = TRUE # show correlation ellipses
             )
```

2.Parallel coordinate plots

useful at finding: outlier; cluster; inverse correlation; positive correlation


```{r}
#Let's first see how school_crime looks like
ggparcoord(school_crime, columns=2:6, groupColumn=1, alpha=0.5, scale='uniminmax',splineFactor=10,
           title = "Modified parallel coordinate plot for NYC school crime")
```
Clearly, we don't see many outliers from School year 2015-2016. Does this means that 2015-2016 is a safer school year?
```{r}
district_crime <- select(school_clean, School.Year, Geographical.District.Code, Major.N, Oth.N, NoCrim.N, Prop.N, Vio.N)
total_crime <- district_crime %>%
  group_by(School.Year) %>%
  summarise(total_major = sum(Major.N), total_oth = sum(Oth.N), total_nocrim = sum(NoCrim.N), total_prop = sum(Prop.N), total_vio = sum(Vio.N))
total_crime
```
Change to time series table
Yes, there are less major crime property crime, and other crime committed in year 2015-2016. Some over time, schools actually got to be safer, or just some school?

3. stack bar chart for type of crime in each borough